library(readr)
library(prob)
library(plyr)
library(graphics)
library(gtools)
setEPS()
TiempoN <- as.data.frame(t(read.csv("Tiempopercolacion.csv", header=FALSE)))
TiempoN1<-as.data.frame(t(read.csv("tiempopercolacionv0.csv", header=FALSE)))
TiempoN2<-as.data.frame(t(read.csv("tiempopercolacionv1.csv", header=FALSE)))
TiempoN3<-as.data.frame(t(read.csv("tiempopercolacionv2.csv", header=FALSE)))
TiempoN4<-as.data.frame(t(read.csv("tiempopercolacionv3.csv", header=FALSE)))
TiempoNT<-smartbind(TiempoN,TiempoN1,TiempoN2,TiempoN3,TiempoN4)
colnames(TiempoNT) <- rep(1,length(TiempoNT))
shapiro.test(t(TiempoNT)) #No son normales
T5<-as.data.frame(TiempoNT[1,1:3])
T10<-as.data.frame(TiempoNT[1,89:103])
T19<-as.data.frame(TiempoNT[1,446:459])

T52<-as.data.frame(TiempoNT[2,1:4])
T102<-as.data.frame(TiempoNT[2,49:69])
T192<-as.data.frame(TiempoNT[2,462:612])

T53<-as.data.frame(TiempoNT[3,1:10])
T103<-as.data.frame(TiempoNT[3,75:116])
T193<-as.data.frame(TiempoNT[3,470:592])

T54<-as.data.frame(TiempoNT[4,1:13])
T104<-as.data.frame(TiempoNT[4,56:75])
T194<-as.data.frame(TiempoNT[4,484:576])

T55<-as.data.frame(TiempoNT[5,1:4])
T105<-as.data.frame(TiempoNT[5,54:64])
T195<-as.data.frame(TiempoNT[5,455:476])
TP<-cbind(T5, T52, T53, T54, T55)
TP1<-cbind(T10, T102, T103, T104,T105)
TP2<-cbind(T19, T192, T193, T194,T195)
colnames(TP) <- c(1:length(TP))
colnames(TP1) <- c(1:length(TP1))
colnames(TP2) <- c(1:length(TP2))

TiempoN2 <- as.data.frame(t(read.csv("Tiempopercolacion2.csv", header=FALSE)))
TiempoN21<-as.data.frame(t(read.csv("tiempopercolacion2v0.csv", header=FALSE)))
TiempoN22<-as.data.frame(t(read.csv("tiempopercolacion2v1.csv", header=FALSE)))
TiempoN23<-as.data.frame(t(read.csv("tiempopercolacion2v2.csv", header=FALSE)))
TiempoN24<-as.data.frame(t(read.csv("tiempopercolacion2v3.csv", header=FALSE)))
TiempoNT2<-smartbind(TiempoN2,TiempoN21,TiempoN22,TiempoN23,TiempoN24)
colnames(TiempoNT2) <- rep(1,length(TiempoNT2))
shapiro.test(t(TiempoNT2)) #No son normales
T25<-as.data.frame(TiempoNT2[1,1:14])
T210<-as.data.frame(TiempoNT2[1,130:188])
T219<-as.data.frame(TiempoNT2[1,1054:1337])

T252<-as.data.frame(TiempoNT2[2,1:21])
T2102<-as.data.frame(TiempoNT2[2,111:139])
T2192<-as.data.frame(TiempoNT2[2,714:761])

T253<-as.data.frame(TiempoNT2[3,1:4])
T2103<-as.data.frame(TiempoNT2[3,47:50])
T2193<-as.data.frame(TiempoNT2[3,601:723])

T254<-as.data.frame(TiempoNT2[4,1:15])
T2104<-as.data.frame(TiempoNT2[4,145:216])
T2194<-as.data.frame(TiempoNT2[4,825:1044])

T255<-as.data.frame(TiempoNT2[5,1:3])
T2105<-as.data.frame(TiempoNT2[5,138:214])
T2195<-as.data.frame(TiempoNT2[5,1120:1214])
TP2<-cbind(T25, T252, T253, T254, T255)
TP21<-cbind(T210, T2102, T2103, T2104,T2105)
TP22<-cbind(T219, T2192, T2193, T2194,T2195)
colnames(TP2) <- c(1:length(TP2))
colnames(TP21) <- c(1:length(TP21))
colnames(TP22) <- c(1:length(TP22))

TTP<-smartbind(TP,TP2, fill = 0)
TTP1<-smartbind(TP1,TP21, fill = 0)
TTP2<-smartbind(TP2,TP22, fill = 0)

postscript("Tiempo5N.eps")
boxplot(t(TTP), xlab=c("Cantidad de nodos eliminados"), ylab=c("Tiempo (segundos)"), plot=TRUE)

postscript("Tiempo10N.eps")
boxplot(t(TTP1), xlab=c("Cantidad de nodos eliminados"), ylab=c("Tiempo (segundos)"), range = TRUE, plot=TRUE)

postscript("Tiempo19N.eps")
boxplot(t(TTP2), xlab=c("Cantidad de nodos eliminados"), ylab=c("Tiempo (segundos)"), range = TRUE, plot=TRUE)


TiempoPA <- as.data.frame(t(read.csv("Tiempopercolaciona1.csv", header=FALSE)))
TiempoPA1<- as.data.frame(t(read.csv("tiempopercolaciona1v0.csv", header=FALSE)))
TiempoPA2<- as.data.frame(t(read.csv("tiempopercolaciona1v1.csv", header=FALSE)))
TiempoPA3<- as.data.frame(t(read.csv("tiempopercolaciona1v2.csv", header=FALSE)))
TiempoPA4<- as.data.frame(t(read.csv("tiempopercolaciona1v3.csv", header=FALSE)))
TiempoPAT<-smartbind(TiempoPA,TiempoPA1,TiempoPA2,TiempoPA3,TiempoPA4)
colnames(TiempoPAT) <- rep(1,length(TiempoPAT))
T5A<-as.data.frame(TiempoPAT[1,1:3])
T10A<-as.data.frame(TiempoPAT[1,43:58])
T19A<-as.data.frame(TiempoPAT[1,292:329])

T52A<-as.data.frame(TiempoPAT[2,1:7])
T102A<-as.data.frame(TiempoPAT[2,42:58])
T192A<-as.data.frame(TiempoPAT[2,381:448])

T53A<-as.data.frame(TiempoPAT[3,1:3])
T103A<-as.data.frame(TiempoPAT[3,38:53])
T193A<-as.data.frame(TiempoPAT[3,307:369])

T54A<-as.data.frame(TiempoPAT[4,1:6])
T104A<-as.data.frame(TiempoPAT[4,41:50])
T194A<-as.data.frame(TiempoPAT[4,372:436])

T55A<-as.data.frame(TiempoPAT[5,1:4])
T105A<-as.data.frame(TiempoPAT[5,41:57])
T195A<-as.data.frame(TiempoPAT[5,345:419])
TPA<-cbind(T5A, T52A, T53A, T54A, T55A)
TP1A<-cbind(T10A, T102A, T103A, T104A,T105A)
TP2A<-cbind(T19A, T192A, T193A, T194A,T195A)
colnames(TPA) <- c(1:length(TPA))
colnames(TP1A) <- c(1:length(TP1A))
colnames(TP2A) <- c(1:length(TP2A))

TiempoPA2 <- as.data.frame(t(read.csv("Tiempopercolaciona2.csv", header=FALSE)))
TiempoPA21<- as.data.frame(t(read.csv("tiempopercolaciona2v0.csv", header=FALSE)))
TiempoPA22<- as.data.frame(t(read.csv("tiempopercolaciona2v1.csv", header=FALSE)))
TiempoPA23<- as.data.frame(t(read.csv("tiempopercolaciona2v2.csv", header=FALSE)))
TiempoPA24<- as.data.frame(t(read.csv("tiempopercolaciona2v3.csv", header=FALSE)))
TiempoPA2T<-smartbind(TiempoPA2,TiempoPA21,TiempoPA22,TiempoPA23,TiempoPA24)
colnames(TiempoPA2T) <- rep(1,length(TiempoPA2T))
T5A2<-as.data.frame(TiempoPA2T[1,1:22])
T10A2<-as.data.frame(TiempoPA2T[1,232:331])
T19A2<-as.data.frame(TiempoPA2T[1,2170:2568])

T52A2<-as.data.frame(TiempoPA2T[2,1:20])
T102A2<-as.data.frame(TiempoPA2T[2,233:334])
T192A2<-as.data.frame(TiempoPA2T[2,2124:2524])

T53A2<-as.data.frame(TiempoPA2T[3,1:21])
T103A2<-as.data.frame(TiempoPA2T[3,238:337])
T193A2<-as.data.frame(TiempoPA2T[3,2138:2536])

T54A2<-as.data.frame(TiempoPA2T[4,1:21])
T104A2<-as.data.frame(TiempoPA2T[4,221:323])
T194A2<-as.data.frame(TiempoPA2T[4,2117:2504])

T55A2<-as.data.frame(TiempoPA2T[5,1:22])
T105A2<-as.data.frame(TiempoPA2T[5,237:337])
T195A2<-as.data.frame(TiempoPA2T[5,2165:2562])
TPA2<-cbind(T5A2, T52A2, T53A2, T54A2, T55A2)
TP1A2<-cbind(T10A2, T102A2, T103A2, T104A2, T105A2)
TP2A2<-cbind(T19A2, T192A2, T193A2, T194A2,T195A2)
colnames(TPA2) <- c(1:length(TPA2))
colnames(TP1A2) <- c(1:length(TP1A2))
colnames(TP2A2) <- c(1:length(TP2A2))

TTPA<-smartbind(TPA,TPA2, fill = 0)
TTPA1<-smartbind(TP1A,TP1A2, fill = 0)
TTPA2<-smartbind(TP2A,TP2A2, fill = 0)

postscript("Tiempos5NA.eps")
boxplot(t(TTPA), xlab=c("Cantidad de percolaciones realizadas"), ylab=c("Flujo máximo"), range = TRUE, plot=TRUE)

postscript("Tiempos10NA.eps")
boxplot(t(TTPA1), xlab=c("Cantidad de percolaciones realizadas"), ylab=c("Flujo máximo"), range = TRUE, plot=TRUE)

postscript("Tiempos19NA.eps")
boxplot(t(TTPA2), xlab=c("Cantidad de percolaciones realizadas"), ylab=c("Flujo máximo"), varwidth=TRUE, range = TRUE, plot=TRUE)
graphics.off()